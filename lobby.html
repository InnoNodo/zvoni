<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Lobby</title>
<style>
  body { display: flex; flex-direction: column; align-items: center; font-family: sans-serif; margin: 0; padding: 20px; }
  video { width: 300px; height: 200px; border: 1px solid #ccc; margin: 10px; background: black; }
  #videos { display: flex; gap: 20px; }
</style>
</head>
<body>
<h1 id="lobbyTitle">Lobby</h1>
<div id="videos">
  <video id="localVideo" autoplay playsinline muted></video>
  <video id="remoteVideo" autoplay playsinline></video>
</div>

<script>
const lobbyID = window.location.pathname.split("/").pop();
document.getElementById("lobbyTitle").innerText = "Lobby " + lobbyID;

const ws = new WebSocket(`ws://localhost:8080/ws?lobbyID=${lobbyID}`);

ws.onopen = () => console.log("‚úÖ Connected to signaling server");
ws.onmessage = (msg) => console.log("üì© Message:", msg.data);

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞
async function startLocalStream() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
    document.getElementById("localVideo").srcObject = stream;
    window.localStream = stream;
  } catch (err) {
    console.error("–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ–¥–∏–∞:", err);
  }
}

startLocalStream();
</script>
</body>
</html>
